{"version":3,"file":"chunks/feedback-4.min.js","mappings":"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","sources":["webpack://plentymarkets-feedback/./resources/js/src/app/store/FeedbackModule.js","webpack://plentymarkets-feedback/./resources/js/src/app/mixins/loadFeedbackModule.js","webpack://plentymarkets-feedback/./resources/js/src/app/components/item/FeedbackAverage.vue","webpack://plentymarkets-feedback/resources/js/src/app/components/item/FeedbackAverage.vue","webpack://plentymarkets-feedback/./resources/js/src/app/components/item/FeedbackAverage.vue?741f","webpack://plentymarkets-feedback/./resources/js/src/app/components/item/FeedbackAverage.vue?b35f","webpack://plentymarkets-feedback/./node_modules/core-js/internals/array-fill.js","webpack://plentymarkets-feedback/./node_modules/core-js/modules/es.array.fill.js"],"sourcesContent":["let loadPaginatedFeedbacksLock = false\r\nlet loadFeedbackUserLock = false\r\n\r\nconst state = () => ({\r\n  authenticatedUser: {},\r\n  counts: {},\r\n  feedbacks: [],\r\n  itemAttributes: [],\r\n  pagination: {\r\n    isLastPage: true,\r\n    lastPage: 1,\r\n    currentPage: 1\r\n  }\r\n})\r\n\r\nconst mutations =\r\n    {\r\n      setFeedbackAuthenticatedUser (state, authenticatedUser) {\r\n        state.authenticatedUser = authenticatedUser\r\n      },\r\n\r\n      setFeedbackCounts (state, counts) {\r\n        state.counts = counts\r\n      },\r\n\r\n      setFeedbacks (state, feedbacks) {\r\n        state.feedbacks = state.feedbacks.concat(feedbacks)\r\n      },\r\n\r\n      setFeedbackItemAttributes (state, attributes) {\r\n        state.itemAttributes = attributes\r\n      },\r\n\r\n      setFeedbackPagination (state, pagination) {\r\n        state.pagination.lastPage = pagination.lastPage\r\n        state.pagination.isLastPage = pagination.isLastPage\r\n      },\r\n\r\n      incrementCurrentFeedbackPage (state) {\r\n        state.pagination.currentPage++\r\n      },\r\n\r\n      addFeedback (state, feedback) {\r\n        // Add the feedback to the current users feedback list\r\n        state.authenticatedUser.feedbacks.unshift(feedback)\r\n\r\n        if (feedback.isVisible) {\r\n          const ratingValue = parseInt(feedback.feedbackRating.rating.ratingValue)\r\n          if (ratingValue > 0 && ratingValue <= 5) {\r\n            state.counts['ratingsCountOf' + ratingValue]++\r\n            state.counts.ratingsCountTotal++\r\n\r\n            recalculateAverage(state)\r\n          }\r\n        }\r\n      },\r\n\r\n      deleteFeedback (state, { feedbackId, parentFeedbackId, feedback }) {\r\n        // If visible, adjust counts\r\n        if (feedback.isVisible && parentFeedbackId === null) {\r\n          const ratingValue = parseInt(feedback.feedbackRating.rating.ratingValue)\r\n          if (ratingValue > 0 && ratingValue <= 5) {\r\n            state.counts['ratingsCountOf' + ratingValue]--\r\n            state.counts.ratingsCountTotal--\r\n\r\n            recalculateAverage(state)\r\n          }\r\n        }\r\n\r\n        if (parentFeedbackId === null) {\r\n          state.feedbacks = filterFeedbackList(state.feedbacks, feedbackId)\r\n          state.authenticatedUser.feedbacks = filterFeedbackList(state.authenticatedUser.feedbacks, feedbackId)\r\n        } else {\r\n          state.feedbacks = filterReplyList(state.feedbacks, parentFeedbackId, feedbackId)\r\n          state.authenticatedUser.feedbacks = filterReplyList(state.authenticatedUser.feedbacks, parentFeedbackId, feedbackId)\r\n        }\r\n      }\r\n    }\r\n\r\nconst actions =\r\n    {\r\n      loadFeedbackUser ({ commit }, { itemId, variationId }) {\r\n        if (!loadFeedbackUserLock) {\r\n          loadFeedbackUserLock = true\r\n          let itemString = ''\r\n\r\n          if (itemId !== undefined && variationId !== undefined) {\r\n            itemString = `/${itemId}/${variationId}`\r\n          }\r\n\r\n          return $.ajax({\r\n            type: 'GET',\r\n            url: '/rest/feedbacks/user' + itemString,\r\n            success: function (data) {\r\n              commit('setFeedbackAuthenticatedUser', data)\r\n              loadFeedbackUserLock = false\r\n            },\r\n            error: function (jqXHR, textStatus, errorThrown) {\r\n              loadFeedbackUserLock = false\r\n              console.error(errorThrown)\r\n            }\r\n          })\r\n        }\r\n      },\r\n\r\n      loadFeedbackCounts ({ commit, state }, itemId) {\r\n        if (!countsLoaded) {\r\n          countsLoaded = true\r\n\r\n          return $.ajax({\r\n            type: 'GET',\r\n            url: '/rest/feedbacks/feedback/helper/counts/' + itemId,\r\n            success: function (data) {\r\n              commit('setFeedbackCounts', data.counts)\r\n            },\r\n            error: function (jqXHR, textStatus, errorThrown) {\r\n              console.error(errorThrown)\r\n            }\r\n          })\r\n        }\r\n      },\r\n\r\n      loadPaginatedFeedbacks ({ commit, state }, { itemId, feedbacksPerPage }) {\r\n        if (!loadPaginatedFeedbacksLock) {\r\n          loadPaginatedFeedbacksLock = true\r\n          const request = $.ajax({\r\n            type: 'GET',\r\n            url: '/rest/feedbacks/feedback/helper/feedbacklist/' + itemId + '/' + state.pagination.currentPage,\r\n            data: {\r\n              feedbacksPerPage: feedbacksPerPage\r\n            },\r\n            success: function (data) {\r\n              commit('setFeedbacks', data.feedbacks)\r\n              commit('setFeedbackItemAttributes', data.itemAttributes)\r\n              commit('setFeedbackPagination', data.pagination)\r\n              loadPaginatedFeedbacksLock = false\r\n            },\r\n            error: function (jqXHR, textStatus, errorThrown) {\r\n              console.error(errorThrown)\r\n              loadPaginatedFeedbacksLock = false\r\n            }\r\n          })\r\n          commit('incrementCurrentFeedbackPage')\r\n          return request\r\n        }\r\n      },\r\n\r\n      deleteFeedback ({ commit, state }, { feedbackId, parentFeedbackId, feedback }) {\r\n        return $.ajax({\r\n          type: 'DELETE',\r\n          url: '/rest/feedbacks/feedback/delete/' + feedbackId,\r\n          success: (data) => {\r\n            commit('deleteFeedback', {\r\n              feedbackId: feedbackId,\r\n              parentFeedbackId: parentFeedbackId,\r\n              feedback: feedback\r\n            })\r\n          }\r\n        })\r\n      }\r\n    }\r\n\r\nconst getters =\r\n    {}\r\n\r\nlet countsLoaded = false\r\n\r\nexport default {\r\n  state,\r\n  mutations,\r\n  actions,\r\n  getters\r\n}\r\n\r\n// Utility functions\r\nfunction filterFeedbackList (feedbackList, feedbackId) {\r\n  return feedbackList.filter(function (feedback) {\r\n    return feedback.id !== feedbackId\r\n  })\r\n}\r\n\r\nfunction filterReplyList (feedbackList, feedbackId, replyId) {\r\n  return feedbackList.map(function (feedback) {\r\n    if (feedbackId === feedback.id) {\r\n      feedback.replies = feedback.replies.filter(function (reply) {\r\n        return reply.id !== replyId\r\n      })\r\n    }\r\n    return feedback\r\n  })\r\n}\r\n\r\nfunction recalculateAverage (state) {\r\n  // Calculate average anew\r\n  let average = 0\r\n  average += state.counts.ratingsCountOf5 * 5\r\n  average += state.counts.ratingsCountOf4 * 4\r\n  average += state.counts.ratingsCountOf3 * 3\r\n  average += state.counts.ratingsCountOf2 * 2\r\n  average += state.counts.ratingsCountOf1 * 1\r\n  average /= state.counts.ratingsCountTotal\r\n\r\n  state.counts.averageValue = average\r\n}\r\n","import FeedbackModule from '../store/FeedbackModule'\r\n\r\nexport default {\r\n  created () {\r\n    if (!this.$store.hasModule('feedback') && !App.isSSR) {\r\n      this.$store.registerModule('feedback', FeedbackModule, { preserveState: !!this.$store.state.feedback })\r\n    }\r\n  }\r\n}\r\n","var render = function render() {\n  var _vm = this,\n    _c = _vm._self._c\n  return _c(\"div\", [\n    _vm.showEmptyRatings || _vm.counts.averageValue > 0\n      ? _c(\"div\", { staticClass: \"feedback-stars-average\", class: _vm.size }, [\n          _c(\n            \"div\",\n            { staticClass: \"feedback-stars-background clearfix\" },\n            _vm._l(5, function (index) {\n              return _c(\n                \"div\",\n                {\n                  key: \"star_background_\" + index,\n                  staticClass: \"feedback-star\",\n                },\n                [_c(\"i\", { staticClass: \"fa fa-star\" })]\n              )\n            }),\n            0\n          ),\n          _vm._v(\" \"),\n          _c(\n            \"div\",\n            {\n              staticClass: \"feedback-stars-overlay-wrap\",\n              style: { width: _vm.fill },\n            },\n            [\n              _c(\n                \"div\",\n                { staticClass: \"feedback-stars-overlay clearfix\" },\n                _vm._l(5, function (index) {\n                  return _c(\n                    \"div\",\n                    {\n                      key: \"star_overlay_\" + index,\n                      staticClass: \"feedback-star\",\n                    },\n                    [_c(\"i\", { staticClass: \"fa fa-star\" })]\n                  )\n                }),\n                0\n              ),\n            ]\n          ),\n        ])\n      : _vm._e(),\n    _vm._v(\" \"),\n    _vm.showRatingsAmount &&\n    (_vm.showEmptyRatings || _vm.counts.averageValue > 0)\n      ? _c(\"span\", { class: _vm.size }, [\n          _c(\n            \"a\",\n            {\n              attrs: { href: \"#\" },\n              on: {\n                click: function ($event) {\n                  $event.preventDefault()\n                  return _vm.scrollTo.apply(null, arguments)\n                },\n              },\n            },\n            [_vm._v(\"(\" + _vm._s(_vm.counts.ratingsCountTotal) + \")\")]\n          ),\n        ])\n      : _vm._e(),\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <div\r\n      v-if=\"showEmptyRatings || counts.averageValue > 0\"\r\n      class=\"feedback-stars-average\"\r\n      :class=\"size\"\r\n    >\r\n      <div class=\"feedback-stars-background clearfix\">\r\n        <div\r\n          v-for=\"index in 5\"\r\n          :key=\"'star_background_' + index\"\r\n          class=\"feedback-star\"\r\n        >\r\n          <i class=\"fa fa-star\" />\r\n        </div>\r\n      </div>\r\n      <div\r\n        class=\"feedback-stars-overlay-wrap\"\r\n        :style=\"{width:fill}\"\r\n      >\r\n        <div class=\"feedback-stars-overlay clearfix\">\r\n          <div\r\n            v-for=\"index in 5\"\r\n            :key=\"'star_overlay_' + index\"\r\n            class=\"feedback-star\"\r\n          >\r\n            <i class=\"fa fa-star\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <span\r\n      v-if=\"showRatingsAmount && (showEmptyRatings || counts.averageValue > 0)\"\r\n      :class=\"size\"\r\n    ><a\r\n      href=\"#\"\r\n      @click.prevent=\"scrollTo\"\r\n    >({{ counts.ratingsCountTotal }})</a></span>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from 'vuex'\r\nimport loadFeedbackModule from '../../mixins/loadFeedbackModule'\r\n\r\nexport default {\r\n  name: 'FeedbackAverage',\r\n  mixins: [loadFeedbackModule],\r\n  inject: {\r\n    itemId: {\r\n      default: null\r\n    }\r\n  },\r\n\r\n  props: {\r\n    showEmptyRatings: Boolean,\r\n    sizeOfStars: {\r\n      type: String,\r\n      default: 'small'\r\n    },\r\n    showRatingsAmount: Boolean\r\n  },\r\n\r\n  computed: {\r\n    fill () {\r\n      let fillValue = (this.counts.averageValue * 100) / 5\r\n      fillValue += '%'\r\n      return fillValue\r\n    },\r\n\r\n    size () {\r\n      return this.sizeOfStars.indexOf('-stars') !== -1 ? this.sizeOfStars : this.sizeOfStars + '-stars'\r\n    },\r\n\r\n    ...mapState({\r\n      counts: state => state.feedback.counts\r\n    })\r\n  },\r\n\r\n  mounted () {\r\n    if (!App.isShopBuilder) {\r\n      this.getAverage()\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    getAverage () {\r\n      this.$store.dispatch('loadFeedbackCounts', this.itemId)\r\n    },\r\n\r\n    scrollTo () {\r\n      let targetElement = document.querySelector('[data-feedback]')\r\n      const headerMargin = document.querySelector('#vue-app').offsetTop\r\n\r\n      if (targetElement) {\r\n        while (!(targetElement.clientHeight && targetElement.classList.contains('widget')) && !!targetElement.parentElement) {\r\n          targetElement = targetElement.parentElement\r\n        }\r\n\r\n        if (targetElement) {\r\n          const elementTop = targetElement.getBoundingClientRect().top + window.scrollY - headerMargin\r\n\r\n          window.scrollTo(\r\n            {\r\n              top: elementTop,\r\n              behavior: 'smooth'\r\n            }\r\n          )\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import mod from \"-!../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FeedbackAverage.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FeedbackAverage.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./FeedbackAverage.vue?vue&type=template&id=51d37fc1\"\nimport script from \"./FeedbackAverage.vue?vue&type=script&lang=js\"\nexport * from \"./FeedbackAverage.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","'use strict';\nvar toObject = require('../internals/to-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\n\n// `Array.prototype.fill` method implementation\n// https://tc39.es/ecma262/#sec-array.prototype.fill\nmodule.exports = function fill(value /* , start = 0, end = @length */) {\n  var O = toObject(this);\n  var length = lengthOfArrayLike(O);\n  var argumentsLength = arguments.length;\n  var index = toAbsoluteIndex(argumentsLength > 1 ? arguments[1] : undefined, length);\n  var end = argumentsLength > 2 ? arguments[2] : undefined;\n  var endPos = end === undefined ? length : toAbsoluteIndex(end, length);\n  while (endPos > index) O[index++] = value;\n  return O;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar fill = require('../internals/array-fill');\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// `Array.prototype.fill` method\n// https://tc39.es/ecma262/#sec-array.prototype.fill\n$({ target: 'Array', proto: true }, {\n  fill: fill\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('fill');\n"],"names":["loadPaginatedFeedbacksLock","loadFeedbackUserLock","mutations","setFeedbackAuthenticatedUser","state","authenticatedUser","setFeedbackCounts","counts","setFeedbacks","feedbacks","concat","setFeedbackItemAttributes","attributes","itemAttributes","setFeedbackPagination","pagination","lastPage","isLastPage","incrementCurrentFeedbackPage","currentPage","addFeedback","feedback","unshift","isVisible","ratingValue","parseInt","feedbackRating","rating","ratingsCountTotal","recalculateAverage","deleteFeedback","_ref","feedbackId","parentFeedbackId","filterFeedbackList","filterReplyList","actions","loadFeedbackUser","_ref2","_ref3","commit","itemId","variationId","itemString","undefined","$","ajax","type","url","success","data","error","jqXHR","textStatus","errorThrown","console","loadFeedbackCounts","_ref4","countsLoaded","loadPaginatedFeedbacks","_ref5","_ref6","feedbacksPerPage","request","_ref7","_ref8","getters","feedbackList","filter","id","replyId","map","replies","reply","average","ratingsCountOf5","ratingsCountOf4","ratingsCountOf3","ratingsCountOf2","ratingsCountOf1","averageValue","created","this","$store","hasModule","App","isSSR","registerModule","FeedbackModule","preserveState","render","_vm","_c","_self","showEmptyRatings","staticClass","class","size","_l","index","key","_v","style","width","fill","_e","showRatingsAmount","attrs","href","on","click","$event","preventDefault","scrollTo","apply","arguments","_s","_withStripped","name","mixins","loadFeedbackModule","inject","default","props","Boolean","sizeOfStars","String","computed","_objectSpread","fillValue","indexOf","mapState","mounted","isShopBuilder","getAverage","methods","dispatch","targetElement","document","querySelector","headerMargin","offsetTop","clientHeight","classList","contains","parentElement","elementTop","getBoundingClientRect","top","window","scrollY","behavior","toObject","toAbsoluteIndex","lengthOfArrayLike","module","exports","value","O","length","argumentsLength","end","endPos","addToUnscopables","target","proto"],"sourceRoot":""}